<?xml version="1.0" encoding="UTF-8"?>
 <!--This file was generated by the ALFA Plugin for Eclipse from Axiomatics AB (http://www.axiomatics.com).
 Any modification to this file will be lost upon recompilation of the source ALFA file-->
<PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
    PolicySetId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global"
    PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
    Version="1.0">
    <Description />
    <PolicySetDefaults>
        <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
    </PolicySetDefaults>
    <Target />
    <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.progressNotes"
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
        Version="1.0">
        <Description>Access Control Based on Category of Action
        URL: http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Access_Control_Based_on_Category_of_Action
        Access to progress notes</Description>
        <PolicyDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicyDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">progress note</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.object.objectType"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule
                Effect="Permit"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.progressNotes.createNote">
            <Description>A primary physician can create a patient's progress note</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.user.role"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                MustBePresent="false"
                            />
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">create</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.action.id"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any">
                    <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.patient.primaryPhysician"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                        MustBePresent="false"
                    />
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.user.requestorId"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                        MustBePresent="false"
                    />
                </Apply>
            </Condition>
        </Rule>
 <Rule Effect="Permit" RuleId="deny-liquor-medicine">
   <Target>
      <AnyOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Liquor</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Medicine</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
      </AnyOf>
   </Target>
  <AdviceExpressions>
    <AdviceExpression AdviceId="deny-liquor-medicine-advice" AppliesTo="Deny">
    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">
	<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">You are not allowed to buy Liquor or Medicine
    from KMarket on-line trading system</AttributeValue>
	</AttributeAssignmentExpression>
    </AdviceExpression>
    </AdviceExpressions>
   </Rule>	
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.progressNotes.updateNote">
            <Description>A physician can update a patient's progress note he/she wrote themselves</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.user.role"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                MustBePresent="false"
                            />
                        </Match>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">update</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.action.id"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any">
                    <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.object.author"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                        MustBePresent="false"
                    />
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.user.requestorId"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                        MustBePresent="false"
                    />
                </Apply>
            </Condition>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.progressNotes.safetyHarness">
            <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
            <Target />
        </Rule>
    </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.assessments"
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
        Version="1.0">
        <Description>Access Control Based on Category of Object
        URL: http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Access_Control_Based_on_Category_of_Object
        Access to patient assessment and payment history</Description>
        <PolicyDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicyDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.role"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">assessment</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.object.objectType"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule
                Effect="Permit"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.assessments.createAssessment">
            <Description>A primary physician can create a patient assessment</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">create</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.action.id"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any">
                    <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.patient.primaryPhysician"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                        MustBePresent="false"
                    />
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.user.requestorId"
                        DataType="http://www.w3.org/2001/XMLSchema#string"
                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                        MustBePresent="false"
                    />
                </Apply>
            </Condition>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.assessments.safetyHarness">
            <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
            <Target />
        </Rule>
    </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.paymentHistory"
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
        Version="1.0">
        <Description>Physicians can access payment history</Description>
        <PolicyDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicyDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.role"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">payment history</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.object.objectType"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule
                Effect="Permit"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.paymentHistory.readPaymentHistory">
            <Description>A primary physician can access a patients payment history only with additional authorization</Description>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.action.id"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                    <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal"/>
                    <AttributeValue
                        DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                    <AttributeDesignator
                        AttributeId="com.axiomatics.hl7.object.administrativeAccess"
                        DataType="http://www.w3.org/2001/XMLSchema#boolean"
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                        MustBePresent="false"
                    />
                </Apply>
            </Condition>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.paymentHistory.safetyHarness">
            <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
            <Target />
        </Rule>
    </Policy>
    <PolicySet xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicySetId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords"
        PolicyCombiningAlgId="urn:oasis:names:tc:xacml:1.0:policy-combining-algorithm:first-applicable"
        Version="1.0">
        <Description />
        <PolicySetDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicySetDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">medical record</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.object.objectType"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
	<Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17" PolicyId="KmarketBluePolicy" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable" Version="1.0">
   <Target>
      <AnyOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">blue</AttributeValue>
               <AttributeDesignator AttributeId="http://kmarket.com/id/role" Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
      </AnyOf>
   </Target>
   <Rule Effect="Deny" RuleId="total-amount">
      <Condition>
        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-greater-than">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only">
               <AttributeDesignator AttributeId="http://kmarket.com/id/totalAmount" Category="http://kmarket.com/category" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true"/>
            </Apply>
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">100</AttributeValue>
         </Apply>
       </Condition>
    <AdviceExpressions>
    <AdviceExpression AdviceId="deny-liquor-medicine-advice" AppliesTo="Deny">
    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">
	<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">You are not allowed to do more than $100 purchase
    from KMarket on-line trading system</AttributeValue>
	</AttributeAssignmentExpression>
    </AdviceExpression>
    </AdviceExpressions>
   </Rule>
   <Rule Effect="Permit" RuleId="deny-liquor-medicine">
   <Target>
      <AnyOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Liquor</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Medicine</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
      </AnyOf>
   </Target>
  <AdviceExpressions>
    <AdviceExpression AdviceId="deny-liquor-medicine-advice" AppliesTo="Deny">
    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">
	<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">You are not allowed to buy Liquor or Medicine
    from KMarket on-line trading system</AttributeValue>
	</AttributeAssignmentExpression>
    </AdviceExpression>
    </AdviceExpressions>
   </Rule>
   <Rule Effect="Permit" RuleId="max-drink-amount">
   <Target>
      <AnyOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Drink</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
      </AnyOf>
   </Target>
      <Condition>
         <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-less-than">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only">
               <AttributeDesignator AttributeId="http://kmarket.com/id/age" Category="http://kmarket.com/category" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true"/>
            </Apply>
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">10</AttributeValue>
         </Apply>
      </Condition>
    <AdviceExpressions>
    <AdviceExpression AdviceId="max-drink-amount-advice" AppliesTo="Deny">
    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">
	<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">You are not allowed to buy more tha 10 Drinks
    from KMarket on-line trading system</AttributeValue>
	</AttributeAssignmentExpression>
    </AdviceExpression>
    </AdviceExpressions>
   </Rule>

   <Rule Effect="Deny" RuleId="max-drink-amount2">
   <Target>
      <AnyOf>
         <AllOf>
            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
               <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Drink</AttributeValue>
               <AttributeDesignator AttributeId="urn:oasis:names:tc:xacml:1.0:resource:resource-id" Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource" DataType="http://www.w3.org/2001/XMLSchema#string" MustBePresent="true"/>
            </Match>
         </AllOf>
      </AnyOf>
   </Target>
      <Condition>
         <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-greater-than">
            <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:integer-one-and-only">
               <AttributeDesignator AttributeId="http://kmarket.com/id/amount" Category="http://kmarket.com/category" DataType="http://www.w3.org/2001/XMLSchema#integer" MustBePresent="true"/>
            </Apply>
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#integer">10</AttributeValue>
         </Apply>
      </Condition>
    <AdviceExpressions>
    <AdviceExpression AdviceId="max-drink-amount-advice" AppliesTo="Deny">
    <AttributeAssignmentExpression AttributeId="urn:oasis:names:tc:xacml:2.0:example:attribute:text">
	<AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">You are not allowed to buy more tha 10 Drinks
    from KMarket on-line trading system</AttributeValue>
	</AttributeAssignmentExpression>
    </AdviceExpression>
    </AdviceExpressions>
   </Rule>
    <Rule RuleId="permit-rule" Effect="Permit"/>    
</Policy>

        <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
            PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.physiciansAccessMedicalRecords"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
            <Description>Access Control Based on Category of Structural Role
            http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Access_Control_Based_on_Category_of_Structural_Role
            Access to Medical Record</Description>
            <PolicyDefaults>
                <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
            </PolicyDefaults>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.user.role"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Rule
                    Effect="Permit"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.physiciansAccessMedicalRecords.readMedicalRecord">
                <Description>A primary physician can read a patients medical record</Description>
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.action.id"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
                <Condition>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any">
                        <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.patient.primaryPhysician"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.requestorId"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Apply>
                </Condition>
            </Rule>
            <Rule
                    Effect="Deny"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.physiciansAccessMedicalRecords.explicitDenyAccess">
                <Description>A patient can explicitly deny a physician access to the medical record</Description>
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.user.explicitDeny"
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
            </Rule>
        </Policy>
        <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
            PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.admissionClerkMedicalRecordAccess"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
            Version="1.0">
            <Description>An admissions clerk can access Medical Records if and only if he/she has additional authority</Description>
            <PolicyDefaults>
                <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
            </PolicyDefaults>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">admissionsClerk</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.user.role"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Rule
                    Effect="Permit"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.admissionClerkMedicalRecordAccess.withAdditionalAuthority">
                <Description />
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.user.additionalAuthority"
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
            </Rule>
        </Policy>
        <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
            PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.healthRelatedProfessionalAccess"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:3.0:rule-combining-algorithm:deny-overrides"
            Version="1.0">
            <Description>A user with the role Health-Related Professional can access only access Medical Records with
            additional authorization</Description>
            <PolicyDefaults>
                <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
            </PolicyDefaults>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.action.id"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
            <Rule
                    Effect="Permit"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.medicalRecords.healthRelatedProfessionalAccess.accessMedicalRecord">
                <Description />
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:boolean-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean">true</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.user.additionalAuthority"
                                    DataType="http://www.w3.org/2001/XMLSchema#boolean"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
            </Rule>
        </Policy>
    </PolicySet>
        <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
            PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.alternatePrivilegedHealthcareProfessionalAccess"
            RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
            Version="1.0">
            <Description>Access Control Based on Category of Functional Role
            http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Access_Control_Based_on_Category_of_Functional_Role

            Allows a user with the role alternate privileged healthcare professional to read or update a
            medical record or sensitive medical information if the primary physician in on vacation</Description>
            <PolicyDefaults>
                <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
            </PolicyDefaults>
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">alternate privileged healthcare professional</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.user.role"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
		<Condition>
		    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of-any">
			<Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:date-less-than"/>
			<AttributeDesignator
			    AttributeId="urn:oasis:names:tc:xacml:1.0:environment:current-date"
			    DataType="http://www.w3.org/2001/XMLSchema#date"
			    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:environment"
			    MustBePresent="false"
			/>
			<AttributeDesignator
			    AttributeId="com.axiomatics.hl7.user.primaryPhysicianVacationEnd"
			    DataType="http://www.w3.org/2001/XMLSchema#date"
			    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
			    MustBePresent="false"
			/>
		    </Apply>
		</Condition>
            <Rule
                    Effect="Permit"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.alternatePrivilegedHealthcareProfessionalAccess.alternateRead">
                <Description />
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.action.id"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
                <Condition>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                            <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">medical record</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                            <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">sensitive medical information</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Apply>
                    </Apply>
                </Condition>
            </Rule>
            <Rule
                    Effect="Permit"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.alternatePrivilegedHealthcareProfessionalAccess.alternateUpdate">
                <Description />
                <Target>
                    <AnyOf>
                        <AllOf>
                            <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                                <AttributeValue
                                    DataType="http://www.w3.org/2001/XMLSchema#string">update</AttributeValue>
                                <AttributeDesignator
                                    AttributeId="com.axiomatics.hl7.action.id"
                                    DataType="http://www.w3.org/2001/XMLSchema#string"
                                    Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                                    MustBePresent="false"
                                />
                            </Match>
                        </AllOf>
                    </AnyOf>
                </Target>
                <Condition>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                            <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">medical record</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Apply>
                        <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                            <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">sensitive medical information</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Apply>
                    </Apply>
                </Condition>
            </Rule>
            <Rule
                    Effect="Deny"
                    RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.alternatePrivilegedHealthcareProfessionalAccess.safetyHarness">
                <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
                <Target />
            </Rule>
        </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.updateCarePlan"
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
        Version="1.0">
        <Description>Access Control Based on Multiple Role Values
        http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Access_Control_Based_on_Multiple_Role_Values
        The security policy requires that in order to update a patient���s care plan a user must
        have the roles of both physician and of member of the hospital staff.</Description>
        <PolicyDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicyDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">update</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.action.id"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                            MustBePresent="false"
                        />
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">care plan</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.object.objectType"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule
                Effect="Permit"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.updateCarePlan.Id_10">
            <Description />
            <Target />
            <Condition>
                <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:or">
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                        <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.role"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Apply>
                    <Apply FunctionId="urn:oasis:names:tc:xacml:1.0:function:any-of">
                        <Function FunctionId="urn:oasis:names:tc:xacml:1.0:function:string-equal"/>
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">hospital staff member</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.role"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Apply>
                </Apply>
            </Condition>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.updateCarePlan.safetyHarness">
            <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
            <Target />
        </Rule>
    </Policy>
    <Policy xmlns="urn:oasis:names:tc:xacml:3.0:core:schema:wd-17"
        PolicyId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.clinicalObjectAccess"
        RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:first-applicable"
        Version="1.0">
        <Description>Enable Design of Access Control System
        http://wiki.hl7.org/index.php?title=Security_and_Privacy_Ontology_Use_Cases#Enable_Design_of_Access_Control_System
        The role of physician can read all clinical objects on the hospital���s EHR-S</Description>
        <PolicyDefaults>
            <XPathVersion>http://www.w3.org/TR/1999/REC-xpath-19991116</XPathVersion>
        </PolicyDefaults>
        <Target>
            <AnyOf>
                <AllOf>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">physician</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.user.role"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            MustBePresent="false"
                        />
                    </Match>
                    <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                        <AttributeValue
                            DataType="http://www.w3.org/2001/XMLSchema#string">read</AttributeValue>
                        <AttributeDesignator
                            AttributeId="com.axiomatics.hl7.action.id"
                            DataType="http://www.w3.org/2001/XMLSchema#string"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:action"
                            MustBePresent="false"
                        />
                    </Match>
                </AllOf>
            </AnyOf>
        </Target>
        <Rule
                Effect="Permit"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.clinicalObjectAccess.clinicalObjectAccess">
            <Description />
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">Clinical Object</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.clinicalObjectAccess.billingStatementAccess">
            <Description />
            <Target>
                <AnyOf>
                    <AllOf>
                        <Match MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
                            <AttributeValue
                                DataType="http://www.w3.org/2001/XMLSchema#string">Billing Statement</AttributeValue>
                            <AttributeDesignator
                                AttributeId="com.axiomatics.hl7.object.objectType"
                                DataType="http://www.w3.org/2001/XMLSchema#string"
                                Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                                MustBePresent="false"
                            />
                        </Match>
                    </AllOf>
                </AnyOf>
            </Target>
        </Rule>
        <Rule
                Effect="Deny"
                RuleId="http://axiomatics.com/alfa/identifier/com.axiomatics.hl7.global.clinicalObjectAccess.safetyHarness">
            <Description>Safety rule to explicitly deny access unless one of the matching rules above has been matched</Description>
            <Target />
        </Rule>
    </Policy>
</PolicySet>
